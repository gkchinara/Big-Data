Q1)

A--
-----------------------------------------
camp_data= LOAD 'final/CampaignData.csv' as (CLICK_FLG,OPEN_FLG,ADDR_VER_CD,AQI,ASIAN_CD,AUTO_IN_MARKET,BIRD_QTY,BUYER_DM_BOOKS,BUYER_DM_COLLECT_SPC_FOOD,BUYER_DM_CRAFTS_HOBBI,BUYER_DM_FEMALE_ORIEN,BUYER_DM_GARDEN_FARM,BUYER_DM_GENERAL,BUYER_DM_GIFT_GADGET,BUYER_DM_MALE_ORIEN,BUYER_DM_UPSCALE,BUYER_MAG_CULINARY_INTERS,BUYER_MAG_FAMILY_GENERAL,BUYER_MAG_FEMALE_ORIENTED,BUYER_MAG_GARDEN_FARMING,BUYER_MAG_HEALTH_FITNESS,BUYER_MAG_MALE_SPORT_ORIENTED,BUYER_MAG_RELIGIOUS,CATS_QTY,CEN_2000_MATCH_LEVEL,CLUB_MEMBER_CD,COUNTRY_OF_ORIGIN,DECEASED_INDICATOR,DM_RESPONDER_HH,DM_RESPONDER_INDIV,DMR_CONTRIB_CAT_GENERAL,DMR_CONTRIB_CAT_HEALTH_INST,DMR_CONTRIB_CAT_POLITICAL,DMR_CONTRIB_CAT_RELIGIOUS,DMR_DO_IT_YOURSELFERS,DMR_MISCELLANEOUS,DMR_NEWS_FINANCIAL,DMR_ODD_ENDS,DMR_PHOTOGRAPHY,DMR_SWEEPSTAKES,DOG_QTY,DWELLING_TYPE,DWELLING_UNIT_SIZE,EST_LOAN_VALUE_RATIO,ETECH_GROUP,ETHNIC_GROUP_CODE,ETHNIC_INSIGHT_MTCH_FLG,ETHNICITY_DETAIL,EXPERIAN_INCOME_CD,EXPERIAN_INCOME_CD_V4,GNDR_OF_CHLDRN_0_3,GNDR_OF_CHLDRN_10_12,GNDR_OF_CHLDRN_13_18,GNDR_OF_CHLDRN_4_6,GNDR_OF_CHLDRN_7_9,HH_INCOME,HHLD_DM_PURC_CD,HOME_BUSINESS_IND,I1_BUSINESS_OWNER_FLG,I1_EXACT_AGE,I1_GNDR_CODE,I1_INDIV_HHLD_STATUS_CODE,INDIV_EDUCATION,INDIV_EDUCATION_CONF_LVL,INDIV_MARITAL_STATUS,INDIV_MARITAL_STATUS_CONF_LVL,INS_MATCH_TYPE,LANGUAGE,LENGTH_OF_RESIDENCE,MEDIAN_HOUSING_VALUE,MEDIAN_LEN_OF_RESIDENCE,MM_INCOME_CD,MOSAIC_HH,MULTI_BUYER_INDIV,NEW_CAR_MODEL,NUM_OF_ADULTS_IN_HHLD,NUMBER_OF_CHLDRN_18_OR_LESS,OCCUP_DETAIL,OCCUP_MIX_PCT,PCT_CHLDRN,PCT_DEROG_TRADES,PCT_HOUSEHOLDS_BLACK,PCT_OWNER_OCCUPIED,PCT_RENTER_OCCUPIED,PCT_TRADES_NOT_DEROG,PCT_WHITE,PHONE_TYPE_CD,PRES_OF_CHLDRN_0_3,PRES_OF_CHLDRN_10_12,PRES_OF_CHLDRN_13_18,PRES_OF_CHLDRN_4_6,PRES_OF_CHLDRN_7_9,PRESENCE_OF_CHLDRN,PRIM_FEM_EDUC_CD,PRIM_FEM_OCC_CD,PRIM_MALE_EDUC_CD,PRIM_MALE_OCC_CD,RECIPIENT_RELIABILITY_CD,RELIGION,SCS_MATCH_TYPE,TRW_INCOME_CD,TRW_INCOME_CD_V4,USED_CAR_CD,Y_OWNS_HOME,Y_PROBABLE_HOMEOWNER,Y_PROBABLE_RENTER,Y_RENTER,YRS_SCHOOLING_CD,Z_CREDIT_CARD,age_hh_mem1,age_hh_mem2,age_hh_mem3,age_hh_mem4,age_hh_mem5,age_hh_mem6,age_hh_mem7,age_hh_mem8,gender_hh_mem1,gender_hh_mem2,gender_hh_mem3,gender_hh_mem4,gender_hh_mem5,gender_hh_mem6,gender_hh_mem7,gender_hh_mem8,statcd_hh_mem1,statcd_hh_mem2,statcd_hh_mem3,statcd_hh_mem4,statcd_hh_mem5,statcd_hh_mem6,statcd_hh_mem7,statcd_hh_mem8,trait_cd1,trait_cd2,trait_cd3,trait_cd4,trait_cd5,trait_cd6,trait_cd7,trait_cd8,trait_cd9,trait_cd10,trait_cd11,trait_cd12,trait_cd13,trait_cd14,trait_cd15,trait_cd16,trait_cd17,trait_cd18,trait_cd19,trait_cd20,trait_cd21,trait_cd22,trait_cd23,trait_cd24,trait_cd25,trait_cd26,trait_cd27,trait_cd28,trait_cd29,trait_cd30,trait_cd31,trait_cd32,trait_cd33,trait_cd34,trait_cd35,trait_cd36,trait_cd37,trait_cd38,trait_cd39,trait_cd40,trait_cd41,trait_cd42,trait_cd43,trait_cd44,trait_cd45,trait_cd46,trait_cd47,trait_cd48,trait_cd49,trait_cd50,trait_cd51,trait_cd52,trait_cd53,trait_cd54,trait_cd55,trait_cd56,trait_cd57,trait_cd58,trait_cd59,trait_cd60,trait_cd61,trait_cd62,trait_cd63,trait_cd64,trait_typ_cd1,trait_typ_cd2,trait_typ_cd3,trait_typ_cd4,trait_typ_cd5,trait_typ_cd6,trait_typ_cd7,trait_typ_cd8,trait_typ_cd9,trait_typ_cd10,trait_typ_cd11,trait_typ_cd12,trait_typ_cd13,trait_typ_cd14,trait_typ_cd15,trait_typ_cd16,trait_typ_cd17,trait_typ_cd18,trait_typ_cd19,trait_typ_cd20,trait_typ_cd21,trait_typ_cd22,trait_typ_cd23,trait_typ_cd24,trait_typ_cd25,trait_typ_cd26,trait_typ_cd27,trait_typ_cd28,trait_typ_cd29,trait_typ_cd30,trait_typ_cd31,trait_typ_cd32,trait_typ_cd33,trait_typ_cd34,trait_typ_cd35,trait_typ_cd36,trait_typ_cd37,trait_typ_cd38,trait_typ_cd39,trait_typ_cd40,trait_typ_cd41,trait_typ_cd42,trait_typ_cd43,trait_typ_cd44,trait_typ_cd45,trait_typ_cd46,trait_typ_cd47,trait_typ_cd48,trait_typ_cd49,trait_typ_cd50,trait_typ_cd51,trait_typ_cd52,trait_typ_cd53,trait_typ_cd54,trait_typ_cd55,trait_typ_cd56,trait_typ_cd57,trait_typ_cd58,trait_typ_cd59,trait_typ_cd60,trait_typ_cd61,trait_typ_cd62,trait_typ_cd63,trait_typ_cd64,CITY,POSTAL_CD,STATE_PROVINCE,new_id,list_auth_cd,list_auth_flg,new_list_id,list_new_brand_cd,list_new_ed_cd,new_mailing_id,Mailing_Category,Mailed_Date);

camp_data= LOAD 'final/CampaignData_sample.csv' USING PigStorage(',') as (CLICK_FLG,OPEN_FLG,ADDR_VER_CD,AQI,ASIAN_CD,AUTO_IN_MARKET,BIRD_QTY,BUYER_DM_BOOKS,BUYER_DM_COLLECT_SPC_FOOD,BUYER_DM_CRAFTS_HOBBI,BUYER_DM_FEMALE_ORIEN,BUYER_DM_GARDEN_FARM,BUYER_DM_GENERAL,BUYER_DM_GIFT_GADGET,BUYER_DM_MALE_ORIEN,BUYER_DM_UPSCALE,BUYER_MAG_CULINARY_INTERS,BUYER_MAG_FAMILY_GENERAL,BUYER_MAG_FEMALE_ORIENTED,BUYER_MAG_GARDEN_FARMING,BUYER_MAG_HEALTH_FITNESS,BUYER_MAG_MALE_SPORT_ORIENTED,BUYER_MAG_RELIGIOUS,CATS_QTY,CEN_2000_MATCH_LEVEL,CLUB_MEMBER_CD,COUNTRY_OF_ORIGIN,DECEASED_INDICATOR,DM_RESPONDER_HH,DM_RESPONDER_INDIV,DMR_CONTRIB_CAT_GENERAL,DMR_CONTRIB_CAT_HEALTH_INST,DMR_CONTRIB_CAT_POLITICAL,DMR_CONTRIB_CAT_RELIGIOUS,DMR_DO_IT_YOURSELFERS,DMR_MISCELLANEOUS,DMR_NEWS_FINANCIAL,DMR_ODD_ENDS,DMR_PHOTOGRAPHY,DMR_SWEEPSTAKES,DOG_QTY,DWELLING_TYPE,DWELLING_UNIT_SIZE,EST_LOAN_VALUE_RATIO,ETECH_GROUP,ETHNIC_GROUP_CODE,ETHNIC_INSIGHT_MTCH_FLG,ETHNICITY_DETAIL,EXPERIAN_INCOME_CD,EXPERIAN_INCOME_CD_V4,GNDR_OF_CHLDRN_0_3,GNDR_OF_CHLDRN_10_12,GNDR_OF_CHLDRN_13_18,GNDR_OF_CHLDRN_4_6,GNDR_OF_CHLDRN_7_9,HH_INCOME,HHLD_DM_PURC_CD,HOME_BUSINESS_IND,I1_BUSINESS_OWNER_FLG,I1_EXACT_AGE,I1_GNDR_CODE,I1_INDIV_HHLD_STATUS_CODE,INDIV_EDUCATION,INDIV_EDUCATION_CONF_LVL,INDIV_MARITAL_STATUS,INDIV_MARITAL_STATUS_CONF_LVL,INS_MATCH_TYPE,LANGUAGE,LENGTH_OF_RESIDENCE,MEDIAN_HOUSING_VALUE,MEDIAN_LEN_OF_RESIDENCE,MM_INCOME_CD,MOSAIC_HH,MULTI_BUYER_INDIV,NEW_CAR_MODEL,NUM_OF_ADULTS_IN_HHLD,NUMBER_OF_CHLDRN_18_OR_LESS,OCCUP_DETAIL,OCCUP_MIX_PCT,PCT_CHLDRN,PCT_DEROG_TRADES,PCT_HOUSEHOLDS_BLACK,PCT_OWNER_OCCUPIED,PCT_RENTER_OCCUPIED,PCT_TRADES_NOT_DEROG,PCT_WHITE,PHONE_TYPE_CD,PRES_OF_CHLDRN_0_3,PRES_OF_CHLDRN_10_12,PRES_OF_CHLDRN_13_18,PRES_OF_CHLDRN_4_6,PRES_OF_CHLDRN_7_9,PRESENCE_OF_CHLDRN,PRIM_FEM_EDUC_CD,PRIM_FEM_OCC_CD,PRIM_MALE_EDUC_CD,PRIM_MALE_OCC_CD,RECIPIENT_RELIABILITY_CD,RELIGION,SCS_MATCH_TYPE,TRW_INCOME_CD,TRW_INCOME_CD_V4,USED_CAR_CD,Y_OWNS_HOME,Y_PROBABLE_HOMEOWNER,Y_PROBABLE_RENTER,Y_RENTER,YRS_SCHOOLING_CD,Z_CREDIT_CARD,age_hh_mem1,age_hh_mem2,age_hh_mem3,age_hh_mem4,age_hh_mem5,age_hh_mem6,age_hh_mem7,age_hh_mem8,gender_hh_mem1,gender_hh_mem2,gender_hh_mem3,gender_hh_mem4,gender_hh_mem5,gender_hh_mem6,gender_hh_mem7,gender_hh_mem8,statcd_hh_mem1,statcd_hh_mem2,statcd_hh_mem3,statcd_hh_mem4,statcd_hh_mem5,statcd_hh_mem6,statcd_hh_mem7,statcd_hh_mem8,trait_cd1,trait_cd2,trait_cd3,trait_cd4,trait_cd5,trait_cd6,trait_cd7,trait_cd8,trait_cd9,trait_cd10,trait_cd11,trait_cd12,trait_cd13,trait_cd14,trait_cd15,trait_cd16,trait_cd17,trait_cd18,trait_cd19,trait_cd20,trait_cd21,trait_cd22,trait_cd23,trait_cd24,trait_cd25,trait_cd26,trait_cd27,trait_cd28,trait_cd29,trait_cd30,trait_cd31,trait_cd32,trait_cd33,trait_cd34,trait_cd35,trait_cd36,trait_cd37,trait_cd38,trait_cd39,trait_cd40,trait_cd41,trait_cd42,trait_cd43,trait_cd44,trait_cd45,trait_cd46,trait_cd47,trait_cd48,trait_cd49,trait_cd50,trait_cd51,trait_cd52,trait_cd53,trait_cd54,trait_cd55,trait_cd56,trait_cd57,trait_cd58,trait_cd59,trait_cd60,trait_cd61,trait_cd62,trait_cd63,trait_cd64,trait_typ_cd1,trait_typ_cd2,trait_typ_cd3,trait_typ_cd4,trait_typ_cd5,trait_typ_cd6,trait_typ_cd7,trait_typ_cd8,trait_typ_cd9,trait_typ_cd10,trait_typ_cd11,trait_typ_cd12,trait_typ_cd13,trait_typ_cd14,trait_typ_cd15,trait_typ_cd16,trait_typ_cd17,trait_typ_cd18,trait_typ_cd19,trait_typ_cd20,trait_typ_cd21,trait_typ_cd22,trait_typ_cd23,trait_typ_cd24,trait_typ_cd25,trait_typ_cd26,trait_typ_cd27,trait_typ_cd28,trait_typ_cd29,trait_typ_cd30,trait_typ_cd31,trait_typ_cd32,trait_typ_cd33,trait_typ_cd34,trait_typ_cd35,trait_typ_cd36,trait_typ_cd37,trait_typ_cd38,trait_typ_cd39,trait_typ_cd40,trait_typ_cd41,trait_typ_cd42,trait_typ_cd43,trait_typ_cd44,trait_typ_cd45,trait_typ_cd46,trait_typ_cd47,trait_typ_cd48,trait_typ_cd49,trait_typ_cd50,trait_typ_cd51,trait_typ_cd52,trait_typ_cd53,trait_typ_cd54,trait_typ_cd55,trait_typ_cd56,trait_typ_cd57,trait_typ_cd58,trait_typ_cd59,trait_typ_cd60,trait_typ_cd61,trait_typ_cd62,trait_typ_cd63,trait_typ_cd64,CITY,POSTAL_CD,STATE_PROVINCE,new_id,list_auth_cd,list_auth_flg,new_list_id,list_new_brand_cd,list_new_ed_cd,new_mailing_id,Mailing_Category,Mailed_Date);

exclude_fst = FILTER camp_data BY CLICK_FLG != 'CLICK_FLG';
all_rows = FOREACH exclude_fst GENERATE CLICK_FLG,OPEN_FLG;
all_rows_lmt = LIMIT five_rows 5;

click = FILTER exclude_fst BY CLICK_FLG == 'Y';
open = FILTER exclude_fst BY OPEN_FLG == 'Y';

click_group_all = Group click All;
open_group_all = Group open All;

click_count = foreach click_group_all  Generate 'same' AS key,COUNT(click.CLICK_FLG) as clk;
open_count = foreach open_group_all  Generate 'same' AS key,COUNT(open.OPEN_FLG) as opn;
dump click_count;
dump open_count;

ctor_join = JOIN click_count BY key, open_count BY key;

ctor = FOREACH ctor_join GENERATE click_count::clk / open_count::opn;

B--
-------------------------------------------------------------------------------------


click_group_gndr = Group click BY I1_GNDR_CODE;
open_group_gndr = Group open BY I1_GNDR_CODE;

click_count = foreach click_group_gndr  Generate group,COUNT(click.CLICK_FLG) as clk;
open_count = foreach open_group_gndr  Generate group,COUNT(open.OPEN_FLG) as opn;

ctor_join = JOIN click_count BY group, open_count BY group;
ctor_by_gndr = FOREACH ctor_join GENERATE click_count::group,(double)click_count::clk / open_count::opn;

 D----
------------------------------------------------------------------------------------------------

 register '/home/Jig11890/piggybank.jar'; 
 camp_data= LOAD 'final/CampaignData_sample.csv' USING org.apache.pig.piggybank.storage.CSVExcelStorage() as (CLICK_FLG,OPEN_FLG,ADDR_VER_CD,AQI,ASIAN_CD,AUTO_IN_MARKET,BIRD_QTY,BUYER_DM_BOOKS,BUYER_DM_COLLECT_SPC_FOOD,BUYER_DM_CRAFTS_HOBBI,BUYER_DM_FEMALE_ORIEN,BUYER_DM_GARDEN_FARM,BUYER_DM_GENERAL,BUYER_DM_GIFT_GADGET,BUYER_DM_MALE_ORIEN,BUYER_DM_UPSCALE,BUYER_MAG_CULINARY_INTERS,BUYER_MAG_FAMILY_GENERAL,BUYER_MAG_FEMALE_ORIENTED,BUYER_MAG_GARDEN_FARMING,BUYER_MAG_HEALTH_FITNESS,BUYER_MAG_MALE_SPORT_ORIENTED,BUYER_MAG_RELIGIOUS,CATS_QTY,CEN_2000_MATCH_LEVEL,CLUB_MEMBER_CD,COUNTRY_OF_ORIGIN,DECEASED_INDICATOR,DM_RESPONDER_HH,DM_RESPONDER_INDIV,DMR_CONTRIB_CAT_GENERAL,DMR_CONTRIB_CAT_HEALTH_INST,DMR_CONTRIB_CAT_POLITICAL,DMR_CONTRIB_CAT_RELIGIOUS,DMR_DO_IT_YOURSELFERS,DMR_MISCELLANEOUS,DMR_NEWS_FINANCIAL,DMR_ODD_ENDS,DMR_PHOTOGRAPHY,DMR_SWEEPSTAKES,DOG_QTY,DWELLING_TYPE,DWELLING_UNIT_SIZE,EST_LOAN_VALUE_RATIO,ETECH_GROUP,ETHNIC_GROUP_CODE,ETHNIC_INSIGHT_MTCH_FLG,ETHNICITY_DETAIL,EXPERIAN_INCOME_CD,EXPERIAN_INCOME_CD_V4,GNDR_OF_CHLDRN_0_3,GNDR_OF_CHLDRN_10_12,GNDR_OF_CHLDRN_13_18,GNDR_OF_CHLDRN_4_6,GNDR_OF_CHLDRN_7_9,HH_INCOME,HHLD_DM_PURC_CD,HOME_BUSINESS_IND,I1_BUSINESS_OWNER_FLG,I1_EXACT_AGE,I1_GNDR_CODE,I1_INDIV_HHLD_STATUS_CODE,INDIV_EDUCATION,INDIV_EDUCATION_CONF_LVL,INDIV_MARITAL_STATUS,INDIV_MARITAL_STATUS_CONF_LVL,INS_MATCH_TYPE,LANGUAGE,LENGTH_OF_RESIDENCE,MEDIAN_HOUSING_VALUE,MEDIAN_LEN_OF_RESIDENCE,MM_INCOME_CD,MOSAIC_HH,MULTI_BUYER_INDIV,NEW_CAR_MODEL,NUM_OF_ADULTS_IN_HHLD,NUMBER_OF_CHLDRN_18_OR_LESS,OCCUP_DETAIL,OCCUP_MIX_PCT,PCT_CHLDRN,PCT_DEROG_TRADES,PCT_HOUSEHOLDS_BLACK,PCT_OWNER_OCCUPIED,PCT_RENTER_OCCUPIED,PCT_TRADES_NOT_DEROG,PCT_WHITE,PHONE_TYPE_CD,PRES_OF_CHLDRN_0_3,PRES_OF_CHLDRN_10_12,PRES_OF_CHLDRN_13_18,PRES_OF_CHLDRN_4_6,PRES_OF_CHLDRN_7_9,PRESENCE_OF_CHLDRN,PRIM_FEM_EDUC_CD,PRIM_FEM_OCC_CD,PRIM_MALE_EDUC_CD,PRIM_MALE_OCC_CD,RECIPIENT_RELIABILITY_CD,RELIGION,SCS_MATCH_TYPE,TRW_INCOME_CD,TRW_INCOME_CD_V4,USED_CAR_CD,Y_OWNS_HOME,Y_PROBABLE_HOMEOWNER,Y_PROBABLE_RENTER,Y_RENTER,YRS_SCHOOLING_CD,Z_CREDIT_CARD,age_hh_mem1,age_hh_mem2,age_hh_mem3,age_hh_mem4,age_hh_mem5,age_hh_mem6,age_hh_mem7,age_hh_mem8,gender_hh_mem1,gender_hh_mem2,gender_hh_mem3,gender_hh_mem4,gender_hh_mem5,gender_hh_mem6,gender_hh_mem7,gender_hh_mem8,statcd_hh_mem1,statcd_hh_mem2,statcd_hh_mem3,statcd_hh_mem4,statcd_hh_mem5,statcd_hh_mem6,statcd_hh_mem7,statcd_hh_mem8,trait_cd1,trait_cd2,trait_cd3,trait_cd4,trait_cd5,trait_cd6,trait_cd7,trait_cd8,trait_cd9,trait_cd10,trait_cd11,trait_cd12,trait_cd13,trait_cd14,trait_cd15,trait_cd16,trait_cd17,trait_cd18,trait_cd19,trait_cd20,trait_cd21,trait_cd22,trait_cd23,trait_cd24,trait_cd25,trait_cd26,trait_cd27,trait_cd28,trait_cd29,trait_cd30,trait_cd31,trait_cd32,trait_cd33,trait_cd34,trait_cd35,trait_cd36,trait_cd37,trait_cd38,trait_cd39,trait_cd40,trait_cd41,trait_cd42,trait_cd43,trait_cd44,trait_cd45,trait_cd46,trait_cd47,trait_cd48,trait_cd49,trait_cd50,trait_cd51,trait_cd52,trait_cd53,trait_cd54,trait_cd55,trait_cd56,trait_cd57,trait_cd58,trait_cd59,trait_cd60,trait_cd61,trait_cd62,trait_cd63,trait_cd64,trait_typ_cd1,trait_typ_cd2,trait_typ_cd3,trait_typ_cd4,trait_typ_cd5,trait_typ_cd6,trait_typ_cd7,trait_typ_cd8,trait_typ_cd9,trait_typ_cd10,trait_typ_cd11,trait_typ_cd12,trait_typ_cd13,trait_typ_cd14,trait_typ_cd15,trait_typ_cd16,trait_typ_cd17,trait_typ_cd18,trait_typ_cd19,trait_typ_cd20,trait_typ_cd21,trait_typ_cd22,trait_typ_cd23,trait_typ_cd24,trait_typ_cd25,trait_typ_cd26,trait_typ_cd27,trait_typ_cd28,trait_typ_cd29,trait_typ_cd30,trait_typ_cd31,trait_typ_cd32,trait_typ_cd33,trait_typ_cd34,trait_typ_cd35,trait_typ_cd36,trait_typ_cd37,trait_typ_cd38,trait_typ_cd39,trait_typ_cd40,trait_typ_cd41,trait_typ_cd42,trait_typ_cd43,trait_typ_cd44,trait_typ_cd45,trait_typ_cd46,trait_typ_cd47,trait_typ_cd48,trait_typ_cd49,trait_typ_cd50,trait_typ_cd51,trait_typ_cd52,trait_typ_cd53,trait_typ_cd54,trait_typ_cd55,trait_typ_cd56,trait_typ_cd57,trait_typ_cd58,trait_typ_cd59,trait_typ_cd60,trait_typ_cd61,trait_typ_cd62,trait_typ_cd63,trait_typ_cd64,CITY,POSTAL_CD,STATE_PROVINCE,new_id,list_auth_cd,list_auth_flg,new_list_id,list_new_brand_cd,list_new_ed_cd,new_mailing_id,Mailing_Category,Mailed_Date);
 exclude_fst = FILTER camp_data BY CLICK_FLG != 'CLICK_FLG';
 flatten_Mailed_Date = FOREACH exclude_fst GENERATE *,SUBSTRING(Mailed_Date,0,3) AS day_week;
 dump flatten_Mailed_Date
 flatten_Mailed_Date = FOREACH exclude_fst GENERATE *,
 (SUBSTRING(Mailed_Date,0,3) == 'Mon' ? 'MONDAY' : 
 (SUBSTRING(Mailed_Date,0,3) == 'Tue' ? 'TUESDAY' : 
 (SUBSTRING(Mailed_Date,0,3) == 'Wed' ? 'WEDNESDAY' : 
 (SUBSTRING(Mailed_Date,0,3) == 'Thu' ? 'THURSDAY' : 
 (SUBSTRING(Mailed_Date,0,3) == 'Fri' ? 'FRIDAY' : 
 (SUBSTRING(Mailed_Date,0,3) == 'Sat' ? 'SATURDAY' : 
 (SUBSTRING(Mailed_Date,0,3) == 'Sun' ? 'SUNDAY' : 
 'NA')))))))  AS fullday_week;
 
 click = FILTER flatten_Mailed_Date BY CLICK_FLG == 'Y';
 open = FILTER flatten_Mailed_Date BY OPEN_FLG == 'Y';
 
 click_group_day_wk = Group click BY fullday_week;
 open_group_day_wk = Group open BY fullday_week;
 
 click_count = foreach click_group_day_wk  Generate group,COUNT(click.CLICK_FLG) as clk;
 open_count = foreach open_group_day_wk  Generate group,COUNT(open.OPEN_FLG) as opn;
 
 ctor_join = JOIN click_count BY group, open_count BY group;
 ctor_by_day_week = FOREACH ctor_join GENERATE click_count::group,(double)click_count::clk / open_count::opn;
 
 F------
 -------------------------------------------------------------------------------------------------------------
income_group_generate = FOREACH exclude_fst GENERATE *,
(TRW_INCOME_CD_V4 == 'J' ? '<$15,000' : 
(TRW_INCOME_CD_V4 == 'K' ? '$15,000-$24,999' :
(TRW_INCOME_CD_V4 == 'L' ? '$25,000-$34,999' :
(TRW_INCOME_CD_V4 == 'M' ? '$35,000-$49,999' :
(TRW_INCOME_CD_V4 == 'N' ? '$50,000-$74,999' :
(TRW_INCOME_CD_V4 == 'O' ? '$75,000-$99,999' :
(TRW_INCOME_CD_V4 == 'P' ? '$100,000-$119,999' :
(TRW_INCOME_CD_V4 == 'Q' ? '$120,000-$149,999' :
(TRW_INCOME_CD_V4 == 'R' ? '$150,000+' :
(TRW_INCOME_CD_V4 == 'U' ? 'Unknown' :
'No match')))))))))) AS Lead_inc_grp;

  click = FILTER income_group_generate BY CLICK_FLG == 'Y';
  open = FILTER income_group_generate BY OPEN_FLG == 'Y';
 
  click_group_incm_grp = Group click BY Lead_inc_grp;
  open_group_incm_grp = Group open BY Lead_inc_grp;
  
  click_count = foreach click_group_day_wk  Generate group,COUNT(click.CLICK_FLG) as clk;
  open_count = foreach open_group_day_wk  Generate group,COUNT(open.OPEN_FLG) as opn;
  
  ctor_join = JOIN click_count BY group, open_count BY group;
  ctor_by_day_week = FOREACH ctor_join GENERATE click_count::group,(double)click_count::clk / open_count::opn;
 
 
 
 Q2)
 ----
 A--
 ----------
 
 register '/home/Jig11890/piggybank.jar'; 
 camp_data= LOAD 'final/CampaignData_sample.csv' USING org.apache.pig.piggybank.storage.CSVExcelStorage() as (CLICK_FLG,OPEN_FLG,ADDR_VER_CD,AQI,ASIAN_CD,AUTO_IN_MARKET,BIRD_QTY,BUYER_DM_BOOKS,BUYER_DM_COLLECT_SPC_FOOD,BUYER_DM_CRAFTS_HOBBI,BUYER_DM_FEMALE_ORIEN,BUYER_DM_GARDEN_FARM,BUYER_DM_GENERAL,BUYER_DM_GIFT_GADGET,BUYER_DM_MALE_ORIEN,BUYER_DM_UPSCALE,BUYER_MAG_CULINARY_INTERS,BUYER_MAG_FAMILY_GENERAL,BUYER_MAG_FEMALE_ORIENTED,BUYER_MAG_GARDEN_FARMING,BUYER_MAG_HEALTH_FITNESS,BUYER_MAG_MALE_SPORT_ORIENTED,BUYER_MAG_RELIGIOUS,CATS_QTY,CEN_2000_MATCH_LEVEL,CLUB_MEMBER_CD,COUNTRY_OF_ORIGIN,DECEASED_INDICATOR,DM_RESPONDER_HH,DM_RESPONDER_INDIV,DMR_CONTRIB_CAT_GENERAL,DMR_CONTRIB_CAT_HEALTH_INST,DMR_CONTRIB_CAT_POLITICAL,DMR_CONTRIB_CAT_RELIGIOUS,DMR_DO_IT_YOURSELFERS,DMR_MISCELLANEOUS,DMR_NEWS_FINANCIAL,DMR_ODD_ENDS,DMR_PHOTOGRAPHY,DMR_SWEEPSTAKES,DOG_QTY,DWELLING_TYPE,DWELLING_UNIT_SIZE,EST_LOAN_VALUE_RATIO,ETECH_GROUP,ETHNIC_GROUP_CODE,ETHNIC_INSIGHT_MTCH_FLG,ETHNICITY_DETAIL,EXPERIAN_INCOME_CD,EXPERIAN_INCOME_CD_V4,GNDR_OF_CHLDRN_0_3,GNDR_OF_CHLDRN_10_12,GNDR_OF_CHLDRN_13_18,GNDR_OF_CHLDRN_4_6,GNDR_OF_CHLDRN_7_9,HH_INCOME,HHLD_DM_PURC_CD,HOME_BUSINESS_IND,I1_BUSINESS_OWNER_FLG,I1_EXACT_AGE,I1_GNDR_CODE,I1_INDIV_HHLD_STATUS_CODE,INDIV_EDUCATION,INDIV_EDUCATION_CONF_LVL,INDIV_MARITAL_STATUS,INDIV_MARITAL_STATUS_CONF_LVL,INS_MATCH_TYPE,LANGUAGE,LENGTH_OF_RESIDENCE,MEDIAN_HOUSING_VALUE,MEDIAN_LEN_OF_RESIDENCE,MM_INCOME_CD,MOSAIC_HH,MULTI_BUYER_INDIV,NEW_CAR_MODEL,NUM_OF_ADULTS_IN_HHLD,NUMBER_OF_CHLDRN_18_OR_LESS,OCCUP_DETAIL,OCCUP_MIX_PCT,PCT_CHLDRN,PCT_DEROG_TRADES,PCT_HOUSEHOLDS_BLACK,PCT_OWNER_OCCUPIED,PCT_RENTER_OCCUPIED,PCT_TRADES_NOT_DEROG,PCT_WHITE,PHONE_TYPE_CD,PRES_OF_CHLDRN_0_3,PRES_OF_CHLDRN_10_12,PRES_OF_CHLDRN_13_18,PRES_OF_CHLDRN_4_6,PRES_OF_CHLDRN_7_9,PRESENCE_OF_CHLDRN,PRIM_FEM_EDUC_CD,PRIM_FEM_OCC_CD,PRIM_MALE_EDUC_CD,PRIM_MALE_OCC_CD,RECIPIENT_RELIABILITY_CD,RELIGION,SCS_MATCH_TYPE,TRW_INCOME_CD,TRW_INCOME_CD_V4,USED_CAR_CD,Y_OWNS_HOME,Y_PROBABLE_HOMEOWNER,Y_PROBABLE_RENTER,Y_RENTER,YRS_SCHOOLING_CD,Z_CREDIT_CARD,age_hh_mem1,age_hh_mem2,age_hh_mem3,age_hh_mem4,age_hh_mem5,age_hh_mem6,age_hh_mem7,age_hh_mem8,gender_hh_mem1,gender_hh_mem2,gender_hh_mem3,gender_hh_mem4,gender_hh_mem5,gender_hh_mem6,gender_hh_mem7,gender_hh_mem8,statcd_hh_mem1,statcd_hh_mem2,statcd_hh_mem3,statcd_hh_mem4,statcd_hh_mem5,statcd_hh_mem6,statcd_hh_mem7,statcd_hh_mem8,trait_cd1,trait_cd2,trait_cd3,trait_cd4,trait_cd5,trait_cd6,trait_cd7,trait_cd8,trait_cd9,trait_cd10,trait_cd11,trait_cd12,trait_cd13,trait_cd14,trait_cd15,trait_cd16,trait_cd17,trait_cd18,trait_cd19,trait_cd20,trait_cd21,trait_cd22,trait_cd23,trait_cd24,trait_cd25,trait_cd26,trait_cd27,trait_cd28,trait_cd29,trait_cd30,trait_cd31,trait_cd32,trait_cd33,trait_cd34,trait_cd35,trait_cd36,trait_cd37,trait_cd38,trait_cd39,trait_cd40,trait_cd41,trait_cd42,trait_cd43,trait_cd44,trait_cd45,trait_cd46,trait_cd47,trait_cd48,trait_cd49,trait_cd50,trait_cd51,trait_cd52,trait_cd53,trait_cd54,trait_cd55,trait_cd56,trait_cd57,trait_cd58,trait_cd59,trait_cd60,trait_cd61,trait_cd62,trait_cd63,trait_cd64,trait_typ_cd1,trait_typ_cd2,trait_typ_cd3,trait_typ_cd4,trait_typ_cd5,trait_typ_cd6,trait_typ_cd7,trait_typ_cd8,trait_typ_cd9,trait_typ_cd10,trait_typ_cd11,trait_typ_cd12,trait_typ_cd13,trait_typ_cd14,trait_typ_cd15,trait_typ_cd16,trait_typ_cd17,trait_typ_cd18,trait_typ_cd19,trait_typ_cd20,trait_typ_cd21,trait_typ_cd22,trait_typ_cd23,trait_typ_cd24,trait_typ_cd25,trait_typ_cd26,trait_typ_cd27,trait_typ_cd28,trait_typ_cd29,trait_typ_cd30,trait_typ_cd31,trait_typ_cd32,trait_typ_cd33,trait_typ_cd34,trait_typ_cd35,trait_typ_cd36,trait_typ_cd37,trait_typ_cd38,trait_typ_cd39,trait_typ_cd40,trait_typ_cd41,trait_typ_cd42,trait_typ_cd43,trait_typ_cd44,trait_typ_cd45,trait_typ_cd46,trait_typ_cd47,trait_typ_cd48,trait_typ_cd49,trait_typ_cd50,trait_typ_cd51,trait_typ_cd52,trait_typ_cd53,trait_typ_cd54,trait_typ_cd55,trait_typ_cd56,trait_typ_cd57,trait_typ_cd58,trait_typ_cd59,trait_typ_cd60,trait_typ_cd61,trait_typ_cd62,trait_typ_cd63,trait_typ_cd64,CITY,POSTAL_CD,STATE_PROVINCE,new_id,list_auth_cd,list_auth_flg,new_list_id,list_new_brand_cd,list_new_ed_cd,new_mailing_id,Mailing_Category,Mailed_Date);
 exclude_fst = FILTER camp_data BY CLICK_FLG != 'CLICK_FLG';
 lead_data = FOREACH exclude_fst GENERATE statcd_hh_mem1..statcd_hh_mem8;
 DUMP lead_data;
 
 count_lead_data = FOREACH exclude_fst GENERATE *,(((statcd_hh_mem1 IS NULL)?0:1)+((statcd_hh_mem2 IS NULL)?0:1)+((statcd_hh_mem3 IS NULL)?0:1)+
												((statcd_hh_mem4 IS NULL)?0:1)+((statcd_hh_mem5 IS NULL)?0:1)+((statcd_hh_mem6 IS NULL)?0:1)) AS lead_cnt;

 fetch_lead_cnt = FOREACH 	count_lead_data GENERATE lead_cnt;
 dump  fetch_lead_cnt
--count_lead_data = FOREACH exclude_fst GENERATE *,(ISNULL(statcd_hh_mem5)? 0 : 1) as cnt;
--count_lead_data = FOREACH exclude_fst GENERATE *,(statcd_hh_mem5 IS NULL ? 0 : 1) as cnt;

 
 
 

 
